# Figures Guide

## Complete Reference for All Generated Visualizations

**Version:** 1.0
**Last Updated:** December 25, 2025

---

## Overview

This guide describes all 20 visualizations generated by the HIV analysis pipeline. Each figure is designed for publication-quality output and includes interpretation guidance.

---

## 1. Drug Resistance Figures

### 1.1 resistance_distance_correlation.png

**Location:** `results/stanford_resistance/`

**Type:** Multi-panel scatter plot with regression lines

**Description:**
Four-panel figure showing hyperbolic distance vs. log₁₀(fold-change) for each drug class.

**Visual Elements:**
- X-axis: Hyperbolic distance from wild-type codon
- Y-axis: Log₁₀(fold-change resistance)
- Points: Individual mutations (color-coded by drug class)
- Lines: Linear regression with 95% CI shading
- Annotations: Pearson r, p-value, n

**How to Read:**
1. Positive slope indicates larger distances = higher resistance
2. Tighter scatter = stronger correlation
3. Compare slopes across panels to assess drug class differences

**Key Insights:**
- NRTI shows steepest slope (strongest relationship)
- INI shows most scatter (weakest relationship)
- All correlations are significant (p < 0.001)

---

### 1.2 primary_accessory_separation.png

**Location:** `results/stanford_resistance/`

**Type:** 2D projection with class coloring

**Description:**
UMAP projection of mutation embeddings showing separation between primary and accessory resistance mutations.

**Visual Elements:**
- Points: Individual mutations
- Colors: Red = Primary, Blue = Accessory
- Contours: Density estimates for each class
- Line: Decision boundary from logistic regression

**How to Read:**
1. Clear separation = good geometric discrimination
2. Overlap region = ambiguous mutations
3. Decision boundary shows classification threshold

**Key Insights:**
- Primary mutations cluster at periphery
- Accessory mutations occupy interior
- ~78% accuracy with geometric features alone

---

### 1.3 cross_resistance_network.png

**Location:** `results/stanford_resistance/`

**Type:** Network graph

**Description:**
Network visualization of drug cross-resistance relationships.

**Visual Elements:**
- Nodes: Drugs (sized by number of mutations)
- Edges: Cross-resistance (weighted by Jaccard similarity)
- Colors: Drug class (PI=red, NRTI=blue, NNRTI=green, INI=purple)
- Clusters: Communities detected by algorithm

**How to Read:**
1. Thicker edges = more shared mutations
2. Closer nodes = higher cross-resistance
3. Clusters = drugs with similar resistance profiles

**Key Insights:**
- IDV-LPV-ATV form tight cluster
- DRV relatively isolated (unique resistance)
- Clear separation between drug classes

---

### 1.4 position_constraint_heatmap.png

**Location:** `results/stanford_resistance/`

**Type:** Heatmap

**Description:**
Position-by-position constraint scores for PR, RT, and IN proteins.

**Visual Elements:**
- X-axis: Amino acid position
- Y-axis: Protein (PR, RT, IN)
- Color: Constraint score (dark = high, light = low)
- Annotations: Key resistance positions labeled

**How to Read:**
1. Dark regions = highly constrained (fewer mutations tolerated)
2. Light regions = variable (many mutations seen)
3. Labeled positions = known resistance sites

**Key Insights:**
- Catalytic sites (D25, T26 in PR) show highest constraint
- Resistance hotspots (82, 84 in PR) show high variance
- RT active site strongly constrained

---

## 2. CTL Escape Figures

### 2.1 protein_radial_distribution.png

**Location:** `results/ctl_escape_expanded/`

**Type:** Violin plot

**Description:**
Distribution of radial positions (constraint) by HIV protein.

**Visual Elements:**
- X-axis: HIV protein (Gag, Pol, Env, Nef, etc.)
- Y-axis: Radial position (0=central/constrained, 1=peripheral/variable)
- Violins: Full distribution for each protein
- Points: Individual epitopes (jittered)
- Boxes: Median and IQR

**How to Read:**
1. Lower position = more constrained epitopes
2. Narrower violin = more consistent constraint
3. Compare medians across proteins

**Key Insights:**
- Gag epitopes most constrained (lowest median)
- Nef epitopes most variable (highest median)
- Env shows bimodal distribution (conserved + variable regions)

---

### 2.2 hla_escape_landscape.png

**Location:** `results/ctl_escape_expanded/`

**Type:** Heatmap

**Description:**
Escape velocity by HLA supertype and target protein.

**Visual Elements:**
- X-axis: HLA supertype (A2, B57, B27, etc.)
- Y-axis: HIV protein
- Color: Escape velocity (dark = slow/constrained, light = fast/easy)
- Annotations: Cell values

**How to Read:**
1. Dark cells = escape is difficult (good for vaccine)
2. Light cells = escape is easy (poor for vaccine)
3. Compare across HLA types for same protein

**Key Insights:**
- B57 restricted epitopes show slowest escape (most constrained)
- A2 restricted epitopes in Env show fast escape
- Gag generally shows slow escape across HLA types

---

### 2.3 conservation_geometry_correlation.png

**Location:** `results/ctl_escape_expanded/`

**Type:** Scatter plot with regression

**Description:**
Correlation between sequence entropy (conservation) and radial position.

**Visual Elements:**
- X-axis: Shannon entropy at epitope positions
- Y-axis: Mean radial position
- Points: Individual epitopes (colored by protein)
- Line: Linear regression
- Annotations: r, p-value, equation

**How to Read:**
1. Positive correlation confirms geometry captures constraint
2. Points along line = well-behaved relationship
3. Outliers = epitopes with unusual properties

**Key Insights:**
- Strong positive correlation (r = 0.67)
- Validates hyperbolic embedding approach
- Some outliers in Env (immune pressure decoupled from function)

---

### 2.4 epitope_clusters.png

**Location:** `results/ctl_escape_expanded/`

**Type:** UMAP projection

**Description:**
2D visualization of epitope clusters based on geometric similarity.

**Visual Elements:**
- Points: Epitopes
- Colors: Cluster assignment
- Labels: Cluster centers with dominant protein
- Annotations: Cluster size and mean HLA count

**How to Read:**
1. Proximity = geometric similarity
2. Colors = distinct clusters
3. Labels identify cluster characteristics

**Key Insights:**
- 10 major clusters identified
- Clusters roughly correspond to proteins
- Some mixed clusters (shared geometric properties across proteins)

---

### 2.5 vaccine_priority_ranking.png

**Location:** `results/ctl_escape_expanded/`

**Type:** Horizontal bar chart

**Description:**
Top 20 vaccine candidate epitopes ranked by priority score.

**Visual Elements:**
- Y-axis: Epitope sequence
- X-axis: Vaccine priority score
- Colors: Target protein
- Annotations: HLA count, resistance overlap status

**How to Read:**
1. Longer bars = higher priority
2. Green labels = no resistance overlap (safe)
3. Red labels = has resistance overlap (caution)

**Key Insights:**
- TPQDLNTML (Gag) is top target
- Nef epitopes dominate top 20
- All top 10 are resistance-free

---

## 3. Antibody Neutralization Figures

### 3.1 breadth_distribution.png

**Location:** `results/catnap_neutralization/`

**Type:** Histogram with overlays

**Description:**
Distribution of antibody neutralization breadth.

**Visual Elements:**
- X-axis: Breadth (fraction of viruses neutralized at IC50 < 50)
- Y-axis: Number of antibodies
- Bars: Histogram of all antibodies
- Overlay: Kernel density estimate
- Vertical lines: bnAb positions labeled

**How to Read:**
1. Right-skewed = most antibodies are broad (CATNAP selection)
2. Labeled lines show where known bnAbs fall
3. Gap between narrow and broad antibodies

**Key Insights:**
- Most CATNAP antibodies are ultra-broad (>80%)
- Known bnAbs cluster around 60-80% breadth
- Few truly narrow antibodies in database

---

### 3.2 bnab_sensitivity.png

**Location:** `results/catnap_neutralization/`

**Type:** Heatmap with annotations

**Description:**
Virus sensitivity patterns for 16 known bnAbs.

**Visual Elements:**
- X-axis: bnAb (ordered by epitope class)
- Y-axis: Virus (clustered by susceptibility)
- Color: log₁₀(IC50) (blue = sensitive, red = resistant)
- Side bars: Epitope class, virus subtype

**How to Read:**
1. Columns show antibody specificity patterns
2. Rows show virus susceptibility profiles
3. Clustered viruses share resistance mechanisms

**Key Insights:**
- Clear epitope class patterns visible
- Some viruses resistant to all bnAbs (Tier 3)
- CD4bs antibodies show most consistent patterns

---

### 3.3 antibody_clustering.png

**Location:** `results/catnap_neutralization/`

**Type:** Dendrogram with heatmap

**Description:**
Hierarchical clustering of antibodies by neutralization profile.

**Visual Elements:**
- Top: Dendrogram showing antibody relationships
- Bottom: Correlation matrix heatmap
- Colors: Correlation strength (red = high, blue = low)
- Labels: Antibody names with epitope class

**How to Read:**
1. Branches show antibody similarity
2. Closely clustered = similar neutralization profiles
3. Large branch distances = different epitope classes

**Key Insights:**
- Five main clusters correspond to epitope classes
- Within-class antibodies cluster together
- Some antibodies bridge clusters (unusual profiles)

---

### 3.4 virus_susceptibility.png

**Location:** `results/catnap_neutralization/`

**Type:** Stacked bar chart

**Description:**
Distribution of viruses by neutralization tier.

**Visual Elements:**
- X-axis: Subtype
- Y-axis: Number of viruses
- Colors: Tier (1A, 1B, 2, 3)
- Stacking: Proportions within each subtype

**How to Read:**
1. Colors show tier distribution
2. Taller bars = more viruses of that subtype
3. Color proportions show subtype-specific patterns

**Key Insights:**
- Subtype B has most viruses (data availability)
- Tier 2 dominates across subtypes
- Subtype C shows higher proportion of Tier 3

---

### 3.5 potency_by_class.png

**Location:** `results/catnap_neutralization/`

**Type:** Box plot with individual points

**Description:**
IC50 distributions by epitope class.

**Visual Elements:**
- X-axis: Epitope class
- Y-axis: log₁₀(IC50)
- Boxes: Median, IQR
- Whiskers: 1.5 × IQR
- Points: Individual measurements (subsampled)

**How to Read:**
1. Lower boxes = more potent
2. Narrower boxes = more consistent potency
3. Outliers show range of values

**Key Insights:**
- V2-glycan and V3-glycan most potent
- Interface antibodies least potent
- MPER shows high variance

---

## 4. Tropism Figures

### 4.1 tropism_separation.png

**Location:** `results/tropism/`

**Type:** 2D PCA projection

**Description:**
Principal component projection of V3 sequences colored by tropism.

**Visual Elements:**
- X-axis: PC1 (primary variance)
- Y-axis: PC2 (secondary variance)
- Points: Individual sequences
- Colors: Red = CCR5, Blue = CXCR4
- Ellipses: 95% confidence regions

**How to Read:**
1. Separation = tropism distinction in this space
2. Overlapping ellipses = limited global separation
3. PC loadings show contributing features

**Key Insights:**
- Significant overlap in global embedding space
- Some separation along PC1
- Position-specific analysis needed for classification

---

### 4.2 position_importance.png

**Location:** `results/tropism/`

**Type:** Bar chart

**Description:**
Tropism discrimination score by V3 position.

**Visual Elements:**
- X-axis: V3 position (1-35)
- Y-axis: Separation score (R5 vs X4 centroid distance)
- Colors: Significance (dark = significant, light = not)
- Annotations: Known determinant positions labeled

**How to Read:**
1. Taller bars = more discriminative positions
2. Labeled positions = literature-validated determinants
3. Dark bars = statistically significant separation

**Key Insights:**
- Position 22 most discriminative (novel finding)
- Positions 11 and 25 confirm 11/25 rule
- Several novel discriminative positions identified

---

### 4.3 classifier_performance.png

**Location:** `results/tropism/`

**Type:** Multi-panel (ROC curves + confusion matrices)

**Description:**
Machine learning classifier performance comparison.

**Visual Elements:**
- Left panel: ROC curves for each classifier
- Right panels: Confusion matrices
- Diagonal: Perfect classifier reference
- Legend: AUC values

**How to Read:**
1. Curves closer to top-left = better performance
2. Higher AUC = better overall discrimination
3. Confusion matrices show error patterns

**Key Insights:**
- All classifiers achieve ~85% accuracy
- Random Forest and Gradient Boosting perform best
- Most errors are R5 misclassified as X4 (conservative)

---

## 5. Integration Figures

### 5.1 tradeoff_landscape.png

**Location:** `results/integrated/`

**Type:** Scatter plot with marginal distributions

**Description:**
Trade-off between drug resistance and immune recognition.

**Visual Elements:**
- X-axis: log₁₀(fold-change) for drug resistance
- Y-axis: Number of HLA restrictions
- Points: Individual overlap positions
- Size: Trade-off score
- Color: Drug class
- Marginals: Histograms of each axis

**How to Read:**
1. Upper-right quadrant = highest trade-off
2. Larger points = higher priority positions
3. Colors show which drug class is affected

**Key Insights:**
- Several positions have both high resistance and broad HLA
- NNRTI positions show highest trade-offs
- Clear gradient from lower-left to upper-right

---

### 5.2 constraint_map.png

**Location:** `results/integrated/`

**Type:** Multi-panel bar chart

**Description:**
Multi-pressure constraint scores by protein region.

**Visual Elements:**
- X-axis: Position along protein
- Y-axis: Constraint score
- Stacked colors: Contribution by pressure type
- Panels: Separate for PR, RT, IN

**How to Read:**
1. Taller bars = more constrained positions
2. Colors show which pressure dominates
3. Compare patterns across proteins

**Key Insights:**
- RT shows highest overall constraint
- Drug pressure dominates in active sites
- CTL pressure more distributed across proteins

---

### 5.3 vaccine_targets.png

**Location:** `results/integrated/`

**Type:** Lollipop chart with annotations

**Description:**
Top 20 vaccine targets with multi-criteria scores.

**Visual Elements:**
- Y-axis: Epitope (ranked by score)
- X-axis: Vaccine priority score
- Points: Score value
- Lines: Connect to axis
- Colors: Target protein
- Icons: Resistance overlap status

**How to Read:**
1. Right = higher priority
2. Green checkmarks = no resistance overlap
3. Red X = has resistance overlap

**Key Insights:**
- All top 10 are resistance-free
- Gag and Nef epitopes dominate
- TPQDLNTML is top candidate

---

## Figure Specifications

### Output Format

All figures are generated with:
- **Format:** PNG (300 DPI for publication)
- **Size:** Variable by figure type
- **Color scheme:** Colorblind-friendly palette
- **Font:** Sans-serif (Arial/Helvetica)

### Customization

Figures can be regenerated with different parameters by modifying the visualization functions in each analysis script.

### Citation

When using these figures, please cite:
```
HIV P-adic Hyperbolic Analysis Pipeline, Version 1.0
Ternary VAE Bioinformatics Research Group, 2025
```

---

**Document Version:** 1.0
**Last Updated:** December 25, 2025
