# Outputs Documentation Guide

> **Comprehensive reference for all outputs generated by the Ternary VAE Bioinformatics project**

**Version:** 1.0
**Last Updated:** December 29, 2025
**Author:** AI Whisperers

---

## Table of Contents

1. [Project Overview](#project-overview)
2. [Mathematical Foundations](#mathematical-foundations)
3. [Key Discoveries](#key-discoveries)
4. [Output Categories](#output-categories)
5. [Data Formats](#data-formats)
6. [Usage Guide](#usage-guide)
7. [Interpretation Guide](#interpretation-guide)
8. [Troubleshooting](#troubleshooting)

---

## Project Overview

The Ternary VAE project applies p-adic number theory and hyperbolic geometry to bioinformatics, with a focus on:

- **HIV vaccine design**: Identifying optimal epitope targets
- **Drug resistance prediction**: Geometric signatures of resistance mutations
- **Protein structure**: Sentinel glycan analysis
- **Partner collaborations**: AMPs, rotamers, arboviruses

### Core Innovation

Traditional sequence-based methods miss hierarchical relationships. This project embeds biological data into hyperbolic space where:
- Radial position encodes evolutionary depth
- Angular position encodes functional similarity
- Geodesic distances preserve phylogenetic relationships

---

## Mathematical Foundations

### P-adic Numbers (3-adic)

The 3-adic metric measures codon distances:

```
d₃(x, y) = 3^(-k)
```

Where `k` is the position of the first differing digit in base-3 representation.

**Example:**
- Codons AAA (000₃) and AAG (002₃) differ at position 3: d = 3⁻³ = 1/27
- Codons AAA (000₃) and GAA (200₃) differ at position 1: d = 3⁻¹ = 1/3

### Valuation

The 3-adic valuation `v(n)` counts trailing zeros in base-3:

| Index | Base-3 | v(n) | Meaning |
|-------|--------|------|---------|
| 0 | 000 | 9 | Deepest hierarchy |
| 1 | 001 | 0 | Outermost |
| 3 | 010 | 1 | Level 1 |
| 9 | 100 | 2 | Level 2 |
| 27 | 1000 | 3 | Level 3 |

### Hyperbolic Geometry (Poincaré Ball)

Embeddings live in the Poincaré ball model:
- Points have radius r < 1 (inside unit ball)
- Radial position encodes hierarchy (higher valuation = closer to center)
- Geodesic distance grows exponentially toward the edge

**Key Formula:**
```python
# Poincaré distance
d_hyp(x, y) = arcosh(1 + 2 * ||x - y||² / ((1 - ||x||²)(1 - ||y||²)))
```

---

## Key Discoveries

### 1. HIV Drug Resistance Geometry

**Finding:** Different drug classes show distinct geometric signatures.

| Drug Class | Distance from WT | Interpretation |
|------------|------------------|----------------|
| NRTI | d = 6.05 | Most constrained |
| NNRTI | d = 5.34 | Moderate |
| INSTI | d = 5.16 | Intermediate |
| PI | d = 3.60 | Most flexible |

**Implication:** NRTI resistance requires larger evolutionary jumps, explaining why NRTIs remain effective backbone therapy.

### 2. Elite Controller HLA Alleles

**Finding:** Protective HLA alleles force HIV into geometrically distant escape mutations.

| HLA Allele | Escape Distance | Protection Level |
|------------|-----------------|------------------|
| HLA-B*27 | d = 7.38 | Highest |
| HLA-B*57:01 | d = 6.34 | High |
| HLA-A*02:01 | d = 4.89 | Moderate |

**Implication:** Escape distance predicts long-term non-progression.

### 3. Sentinel Glycans (Goldilocks Zone)

**Finding:** 7 glycosylation sites show optimal shielding behavior.

| Site | Centroid Shift | Goldilocks Score |
|------|----------------|------------------|
| N58 | 18% | 0.72 |
| N429 | 28% | 0.89 |
| N103 | 22% | 0.78 |
| N204 | 19% | 0.74 |
| N107 | 21% | 0.76 |
| N271 | 17% | 0.68 |
| N265 | 16% | 0.65 |

**Goldilocks Zone:** 15-30% centroid shift upon deglycosylation indicates glycans that shield epitopes but aren't structurally essential.

### 4. AlphaFold3 Validation

**Finding:** Strong inverse correlation between Goldilocks score and structural stability.

```
r = -0.89 (Goldilocks score vs. ipTM)
```

Sites in the Goldilocks Zone show:
- 75-100% disorder upon deglycosylation
- Complete loss of ipTM confidence
- Dramatic structural rearrangement

---

## Output Categories

### Research (`results/research/`)

| Subdirectory | Contents | Format |
|--------------|----------|--------|
| `discoveries/hiv/` | HIV-specific findings | MD, JSON |
| `research_discoveries/` | Core research insights | MD |
| `advanced_research/` | Extended analysis | MD, JSON |
| `comprehensive_analysis/` | Full reports | MD |

**Key Files:**
- `DISCOVERY_HIV_PADIC_RESISTANCE.md` - Drug resistance geometry
- `RESEARCH_FINDINGS.md` - Summary of discoveries
- `COMPREHENSIVE_HIV_RESEARCH_REPORT.md` - Full HIV analysis

### Clinical (`results/clinical/`)

| Subdirectory | Contents | Format |
|--------------|----------|--------|
| `clinical_applications/` | Decision support data | MD, JSON |
| `clinical_dashboard/` | Dashboard-ready data | JSON |
| `clinical_integration/` | Integration outputs | JSON |

**Key Files:**
- `CLINICAL_REPORT.md` - Vaccine candidates, MDR alerts
- `clinical_decision_support.json` - Machine-readable clinical data

### Partners (`results/partners/`)

| Subdirectory | Collaborator | Focus |
|--------------|--------------|-------|
| `brizuela/` | Carlos Brizuela | Antimicrobial peptides |
| `colbes/` | Dr. José Colbes | Rotamer stability |
| `rojas/` | Alejandra Rojas | Arbovirus forecasting |

**Key Files:**
- `VALIDATION_SUMMARY.md` - All partner results
- `rotamer_stability.json` - Rotamer predictions
- `dengue_forecast.json` - Outbreak predictions

### Validation (`results/validation/`)

| Subdirectory | Contents | Format |
|--------------|----------|--------|
| `alphafold_predictions/` | AF3 structure predictions | JSON, PDB |
| `benchmarks/` | Method comparisons | MD, JSON |

**Key Files:**
- `VALIDATION_RESULTS.md` - AF3 validation summary
- `terms_of_use.md` - AlphaFold licensing
- `RESOLUTION_COMPARISON.md` - Benchmark results

### Training (`results/training/`)

| Subdirectory | Contents | Format |
|--------------|----------|--------|
| `logs/` | Training logs | TensorBoard |
| `metrics/` | Numeric metrics | JSON, CSV |
| `run_history/` | Historical runs | TensorBoard |

**Key Files:**
- `DEVELOPMENT_LOG.md` - Training decisions and rationale

---

## Data Formats

### JSON Schema: Clinical Decision Support

```json
{
  "vaccine_candidates": [
    {
      "peptide": "TPQDLNTML",
      "protein": "Gag",
      "priority": 0.970,
      "escape_distance": 5.2,
      "hla_coverage": 0.85
    }
  ],
  "mdr_alerts": [
    {
      "sequence_id": "HIV-2024-001",
      "risk_level": "high",
      "mutations": ["I54V", "L10I"],
      "drug_classes_affected": ["PI"]
    }
  ],
  "tat_targets": [
    {
      "human_protein": "CDK9",
      "druggability": 0.92,
      "interaction_type": "direct"
    }
  ]
}
```

### JSON Schema: Ablation Results

```json
{
  "experiment_name": "loss_triplet_monotonic",
  "config": {
    "loss_function": "triplet_monotonic",
    "beta_schedule": "linear",
    "learning_rate": 0.001
  },
  "metrics": {
    "final_accuracy": 0.956,
    "final_hierarchy": -0.546,
    "best_epoch": 87,
    "total_epochs": 100
  }
}
```

### Markdown Report Structure

```markdown
# Report Title

## Executive Summary
- Key findings (3-5 bullet points)

## Methods
- Data sources
- Analysis pipeline

## Results
### Finding 1
- Data
- Interpretation

### Finding 2
...

## Clinical Implications
- Actionable recommendations

## References
- Citations
```

---

## Usage Guide

### Loading Results in Python

```python
import json
from pathlib import Path

OUTPUTS = Path("outputs")

# Load clinical data
with open(OUTPUTS / "results/clinical/clinical_applications/clinical_decision_support.json") as f:
    clinical = json.load(f)

# Access vaccine candidates
for candidate in clinical["vaccine_candidates"]:
    print(f"{candidate['peptide']}: priority={candidate['priority']}")

# Load ablation results
with open(OUTPUTS / "comprehensive_results.json") as f:
    ablation = json.load(f)

# Find best configuration
best = max(ablation["experiments"], key=lambda x: abs(x["hierarchy"]))
print(f"Best hierarchy: {best['name']} = {best['hierarchy']}")
```

### Accessing Training Metrics

```python
from tensorboard.backend.event_processing import event_accumulator

# Load specific run
ea = event_accumulator.EventAccumulator(
    "outputs/results/training/run_history/archive/ternary_vae_20251212_225619"
)
ea.Reload()

# Get hierarchy correlation over time
hierarchy = ea.Scalars("Hyperbolic_Correlation_Hyp_VAE_B")
epochs = [s.step for s in hierarchy]
values = [s.value for s in hierarchy]
```

### Visualizing Results

```python
import matplotlib.pyplot as plt
import json

# Load and plot ablation comparison
with open("outputs/comprehensive_results.json") as f:
    results = json.load(f)

names = [exp["name"] for exp in results["experiments"]]
hierarchies = [abs(exp["hierarchy"]) for exp in results["experiments"]]

plt.figure(figsize=(12, 6))
plt.barh(names, hierarchies)
plt.xlabel("Hierarchy (absolute Spearman correlation)")
plt.title("Ablation Study: Hierarchy Comparison")
plt.tight_layout()
plt.savefig("hierarchy_comparison.png")
```

---

## Interpretation Guide

### Hierarchy Correlation

| Value | Interpretation |
|-------|----------------|
| -0.8 to -1.0 | Excellent - strong p-adic ordering |
| -0.5 to -0.8 | Good - moderate ordering |
| -0.2 to -0.5 | Weak - some structure |
| 0.0 to -0.2 | Poor - minimal hierarchy |
| Positive | Inverted - wrong ordering |

**Note:** The theoretical ceiling is -0.8321 with any within-level variance.

### Coverage

| Value | Interpretation |
|-------|----------------|
| 100% | Perfect reconstruction |
| 95-99% | Excellent |
| 90-95% | Good |
| < 90% | Needs improvement |

### Richness

| Value | Interpretation |
|-------|----------------|
| > 0.005 | Excellent - high within-level diversity |
| 0.001-0.005 | Good - moderate diversity |
| < 0.001 | Low - possible collapse |
| 0 | Collapsed - trivial shells |

### Goldilocks Score

| Value | Interpretation |
|-------|----------------|
| 0.8-1.0 | Optimal vaccine target |
| 0.6-0.8 | Good candidate |
| 0.4-0.6 | Moderate potential |
| < 0.4 | Not recommended |

---

## Troubleshooting

### Missing LFS Files

```bash
# Pull LFS files
git lfs pull

# Check LFS status
git lfs ls-files
```

### JSON Parsing Errors

```python
# Handle encoding issues
with open(filepath, 'r', encoding='utf-8') as f:
    data = json.load(f)
```

### Large File Loading

```python
# For large TensorBoard logs, use incremental loading
ea = event_accumulator.EventAccumulator(
    path,
    size_guidance={
        event_accumulator.SCALARS: 1000,
        event_accumulator.HISTOGRAMS: 0,
        event_accumulator.IMAGES: 0,
    }
)
```

### Checkpoint Not Found

```bash
# Download from Hugging Face Hub
python -m src.utils.checkpoint_hub download --checkpoint homeostatic_rich/best.pt
```

---

## Appendix: File Inventory

### Root Level Files

| File | Size | Description |
|------|------|-------------|
| `comprehensive_results.json` | ~50 KB | Main ablation study (31 experiments) |
| `combination_results.json` | ~20 KB | Combination experiments |
| `extended_results.json` | ~30 KB | Extended experiments |
| `phase2_results.json` | ~15 KB | Phase 2 results |
| `phase3_results.json` | ~15 KB | Phase 3 results |

### Research Files

| File | Description |
|------|-------------|
| `DISCOVERY_HIV_PADIC_RESISTANCE.md` | Drug resistance geometry |
| `RESEARCH_FINDINGS.md` | Core discoveries |
| `COMPREHENSIVE_HIV_RESEARCH_REPORT.md` | Full HIV analysis |
| `ADVANCED_RESEARCH.md` | Extended analysis |

### Clinical Files

| File | Description |
|------|-------------|
| `CLINICAL_REPORT.md` | Clinical recommendations |
| `clinical_decision_support.json` | Machine-readable data |
| `report_HIV-2024-001.json` | Sample patient report |

### Validation Files

| File | Description |
|------|-------------|
| `VALIDATION_RESULTS.md` | AF3 validation summary |
| `RESOLUTION_COMPARISON.md` | Benchmark results |
| `BG505_*.json` | AF3 structure predictions |

---

## Version History

| Version | Date | Changes |
|---------|------|---------|
| 1.0 | 2025-12-29 | Initial documentation |

---

## Contact

For questions about outputs:
- See `.claude/CLAUDE.md` for project context
- Check `docs/` for additional documentation
- Review `research/` for analysis scripts
